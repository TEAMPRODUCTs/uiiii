<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
test
</body>
<script type="text/javascript" src="res/libs/avalon_1.5.2.js"></script>
<script type="text/javascript">
    var vm = avalon.define({
        $id: "test",
        array: [1, 2, 3],
        arr: [{a: 1}, {a: 2}, {a: 3}],
        selected_den:{
            "column":[],
            "row":[],
            "magnanimity":[],
            "filter":[]//{name:"访问日期", id:"date", value:{},title:"2014-1-1~2015-6-5"},{name:"访问日期1", id:"date1", value:{},title:"2014-11-1~2015-16-5"}
        },
        obj: {
            a: 1,
            b: 2
        },
        a: {
            b: {
                c: {
                    d: 33
                }
            }
        }
    })
    vm.$watch("selected_den.*.length", function(a, b){
        console.log("selected_den.*.length" + a + " " + b);
    });
    vm.$watch("$all", function (a,b) {
        console.log("$all " + a + " " + b);
    });
    vm.$watch("array", function (a, b) {
        console.log("array " + a + " " + b);
        //expect(a).to.be(6)
        // expect(b).to.be(2)
    })

    vm.$watch("array.length",function(a, b){
        console.log("array " + a + " " + b);
    });

    vm.$watch("array.*", function (a, b) {
        console.log("array.* " + a + " " + b);
        //expect(a).to.be(6)
       // expect(b).to.be(2)
    })
    vm.$watch("arr.*.a", function (a, b) {
        console.log("arr.*.a" + a + " " + b);
       // expect(a).to.be(99)
       // expect(b).to.be(1)
    })
    vm.$watch("obj.*", function (a, b, c) {
        console.log("obj.*" + a + " " + b + " " + c);
       // expect(a).to.be(111)
       // expect(b).to.be(1)
    })
    vm.$watch("a.*.c.d", function (a, b, c) {
        console.log("a.*.c.d" + a + " " + b + " " + c);
        //expect(a).to.be(88)
       // expect(b).to.be(33)
    })
    setTimeout(function () {
        //vm.array = vm.array.splice(1, 6)
        vm.array.removeAt(1);
        console.log(JSON.stringify(vm.array));
       // vm.array.set(1, 6)
       // vm.arr[0].a = 99
        vm.arr.removeAt(1);
        vm.selected_den.filter.push({a:1,b:"2"});
        console.log(JSON.stringify( vm.arr));
        vm.selected_den.filter.pop();
        vm.obj.a = 111
        vm.a.b.c.d = 88
    }, 100)
   // $watch会返回一个函数,用于解除监听:

    var unwatch = vm.$watch("array.*", function (a, b) {
    /*    expect(a).to.be(6)
        expect(b).to.be(2)*/
    })
   // unwatch() //移除当前$watch回调

</script>
</html>