<!DOCTYPE html>

<html>
    <head>
       <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
       <script type="text/javascript" src="../../common/libs/jquery-2.1.1.js"></script>
       <style type="text/css">
         #test{
          border-collapse:collapse;
          border:1px solid #ddd;
        }
         #test th,#test td{
          border:1px solid #ddd;
        }
       </style>
       <!--
         如何做1像素细边框的table 
        -->
    </head>
    <body>
        <div>惰性载入表示函数执行的分支仅会发生一次</div>
        <table id="test">
            <tr><th>姓名</th><td>Joy Du</td></tr>
            <tr><th>年龄</th><td>26</td></tr>
        </table>
    </body>
    <script type="text/javascript">
        function createXHR(){
          if(typeof XMLHttpRequest != "undefined"){
                createXHR = function(){
                  return new XMLHttpRequest();
                };
          }else if(typeof ActiveXObject != "undefined"){
              createXHR = function(){
                if(typeof arguments.callee.activeXString != "string"){
                  var versions = ["MSXML2.XMLHttp.6.0", "MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"], i , len;
                  for (var i = versions.length - 1; i >= 0; i--) {
                    try{
                      new ActiveXObject(versions[i]);
                      arguments.callee.activeXString = versions[i];
                      break;
                    }catch(ex){
                      //skip
                    }
                  }
                }
                return new ActiveXObject(arguments.callee.activeXString);
              };
          }else{
            createXHR = function(){
              throw new Error("No XHR object available");
            }
          }
          return createXHR();
        };
        
        var createXHR1 = (function(){
            if(typeof XMLHttpRequest != "undefined"){
                  return function(){
                    return new XMLHttpRequest();
                  };
            }else if(typeof ActiveXObject != "undefined"){
                return function(){
                  if(typeof arguments.callee.activeXString != "string"){
                    var versions = ["MSXML2.XMLHttp.6.0", "MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"], i , len;
                    for (var i = versions.length - 1; i >= 0; i--) {
                      try{
                        new ActiveXObject(versions[i]);
                        arguments.callee.activeXString = versions[i];
                        break;
                      }catch(ex){
                        //skip
                      }
                    }
                  }
                  return new ActiveXObject(arguments.callee.activeXString);
                };
            }else{
               return function(){
                throw new Error("No XHR object available");
              }
            }
        })();
    </script>
</html>